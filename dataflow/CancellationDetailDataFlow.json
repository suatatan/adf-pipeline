{
	"name": "CancellationDetailDataFlow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CancellationDetailsFile",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "CancellationDetailsSQL",
						"type": "DatasetReference"
					},
					"name": "CancellationDetailsSink"
				}
			],
			"transformations": [
				{
					"name": "SourceCancellationDetails"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {Claim Number} as string,",
				"          {Contract Number} as string,",
				"          Activity as string,",
				"          {Agent Name} as string,",
				"          {Agent Number} as string,",
				"          {Alternate Name} as string,",
				"          {Check Number} as string,",
				"          {Claim Description} as string,",
				"          {Claim Detail Status} as string,",
				"          {Claim Mileage} as string,",
				"          {Claim Status} as string,",
				"          {Coverage Code} as string,",
				"          {Coverage Name} as string,",
				"          {Created By} as string,",
				"          {Customer Address 1} as string,",
				"          {Customer Address 2} as string,",
				"          {Customer City} as string,",
				"          {Customer Country} as string,",
				"          {Customer Email} as string,",
				"          {Customer First Name} as string,",
				"          {Customer Last name} as string,",
				"          {Customer Phone} as string,",
				"          {Customer State} as string,",
				"          {Customer Zip} as string,",
				"          {Claim Date Claim is Reported} as string,",
				"          {Date Paid} as string,",
				"          Insurer as string,",
				"          {Labor Cost} as string,",
				"          {Labor Tax 1} as string,",
				"          {Labor Tax 2} as string,",
				"          {Loss Cause Code} as string,",
				"          {Loss Code} as string,",
				"          {Loss Code Description} as string,",
				"          Make as string,",
				"          {Part Tax 1} as string,",
				"          {Part Tax 2} as string,",
				"          {Parts Cost} as string,",
				"          {Pay Method} as string,",
				"          {Payee Name} as string,",
				"          {Payee Type} as string,",
				"          {Payment Method} as string,",
				"          {Repair Completion Date} as string,",
				"          {RO Number} as string,",
				"          sActivityCode as string,",
				"          {Sale Date} as string,",
				"          {Sale Odom} as string,",
				"          {Selling Dealer Address} as string,",
				"          {Selling Dealer City} as string,",
				"          {Selling Dealer Name} as string,",
				"          {Selling Dealer Number} as string,",
				"          {Selling Dealer State} as string,",
				"          {Selling Dealer Zip} as string,",
				"          {Servicer Address} as string,",
				"          {Servicer City} as string,",
				"          {Servicer Email} as string,",
				"          {Servicer Name} as string,",
				"          {Servicer Number} as string,",
				"          {Servicer Phone} as string,",
				"          {Servicer State} as string,",
				"          {Servicer Zip} as string,",
				"          {Term Month} as string,",
				"          {Total Labor Tax} as string,",
				"          {Total Paid Amount} as string,",
				"          {Total Part Tax} as string,",
				"          {TPA Code} as string,",
				"          {Vehicle Age Type} as string,",
				"          {Vehicle Model} as string,",
				"          VIN as string,",
				"          Year as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     limit: 20,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 derive(each(match(locate(\"Amount\",name)>0), $$ = toDecimal($$,18,2)),",
				"          each(match(locate(\"Fee\",name)>0), $$ = toDecimal($$,18,2)),",
				"          each(match(locate(\"Tax\",name)>0), $$ = toDecimal($$,18,2)),",
				"          each(match(locate(\"Cost\",name)>0), $$ = toDecimal($$,18,2)),",
				"          each(match(), ERROR_FUNCTION('') = toDate({$$}, \"YYYY-MM-DD\"))) ~> SourceCancellationDetails",
				"SourceCancellationDetails sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     )) ~> CancellationDetailsSink"
			]
		}
	}
}