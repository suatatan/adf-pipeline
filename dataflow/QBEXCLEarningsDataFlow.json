{
	"name": "QBEXCLEarningsDataFlow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "QBEXCLEarnings",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "QBEXCLEarningsSQL",
						"type": "DatasetReference"
					},
					"name": "sink1",
					"rejectedDataLinkedService": {
						"referenceName": "AzureBlobStorageLog",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {TPA Code} as string,",
				"          {Contract Id} as string,",
				"          {Accounting Month} as string,",
				"          {Insurer Code} as string,",
				"          {Product Type Code} as string,",
				"          {Agent Number} as string,",
				"          {Agent Name} as string,",
				"          {Seller Type} as string,",
				"          {Dealer Number} as string,",
				"          {Dealer Name} as string,",
				"          {Stock Number} as string,",
				"          {Contract Number} as string,",
				"          {Contract Status} as string,",
				"          {Term Months} as string,",
				"          {Term Miles} as string,",
				"          {Sale Odometer} as string,",
				"          {Sale Date} as string,",
				"          {Effective Date} as string,",
				"          {Expiration Date} as string,",
				"          {Activation Date} as string,",
				"          {Activated Year-Month} as string,",
				"          {Billed Date} as string,",
				"          {Cancellation Date} as string,",
				"          {Coverage Code} as string,",
				"          {Coverage Description} as string,",
				"          {Coverage Group Code} as string,",
				"          {Report Group Code} as string,",
				"          {Written NET Amount} as string,",
				"          {Cancel NET Amount} as string,",
				"          {NET Contract Amount} as string,",
				"          {Cancel Fee Amount} as string,",
				"          {Paid Claim Deduction} as string,",
				"          {Retail Amount} as string,",
				"          {Cancel Retail Amount} as string,",
				"          {NET Retail Amount} as string,",
				"          {Retail Refund Amount} as string,",
				"          {Earning Date} as string,",
				"          {Earning Curve 1 Id} as string,",
				"          {Earning Curve Name 1} as string,",
				"          {Earning Factor Current 1} as string,",
				"          {Earning Factor Cumulative 1} as string,",
				"          {Admin Amount 1} as string,",
				"          {Cancel Admin Amount 1} as string,",
				"          {NET Admin Amount 1} as string,",
				"          {Admin Earned Current 1} as string,",
				"          {Admin Earned Cumulative 1} as string,",
				"          {Admin Unearned 1} as string,",
				"          {Reserve Amount 1} as string,",
				"          {Cancel Reserve Amount 1} as string,",
				"          {NET Reserve Amount 1} as string,",
				"          {Reserve Earned Current 1} as string,",
				"          {Reserve Earned Cumulative 1} as string,",
				"          {Reserve Unearned 1} as string,",
				"          {Commission Amount 1} as string,",
				"          {Cancel Commission Amount 1} as string,",
				"          {NET Commission Amount 1} as string,",
				"          {Commission Earned Current 1} as string,",
				"          {Commission Earned Cumulative 1} as string,",
				"          {Commission Unearned 1} as string,",
				"          {NET Contract Amount 1} as string,",
				"          {NET Earned Current 1} as string,",
				"          {NET Earned Cumulative 1} as string,",
				"          {NET Unearned 1} as string,",
				"          {NET RetailAmount 1} as string,",
				"          {Retail Earned Current 1} as string,",
				"          {Retail Earned Cumulative 1} as string,",
				"          {Retail Unearned 1} as string,",
				"          {Earning Curve 2 Id} as string,",
				"          {Earning Curve Name 2} as string,",
				"          {Earning Factor Current 2} as string,",
				"          {Earning Factor Cumulative 2} as string,",
				"          {Admin Amount 2} as string,",
				"          {Cancel Admin Amount 2} as string,",
				"          {NET Admin Amount 2} as string,",
				"          {Admin Earned Current 2} as string,",
				"          {Admin Earned Cumulative 2} as string,",
				"          {Admin Unearned 2} as string,",
				"          {Reserve Amount 2} as string,",
				"          {Cancel Reserve Amount2} as string,",
				"          {NET Reserve Amount 2} as string,",
				"          {Reserve Earned Current 2} as string,",
				"          {Reserve Earned Cumulative 2} as string,",
				"          {Reserve Unearned 2} as string,",
				"          {Commission Amount2} as string,",
				"          {Cancel Commission Amount 2} as string,",
				"          {NET Commission Amount 2} as string,",
				"          {Commission Earned Current 2} as string,",
				"          {Commission Earned Cumulative 2} as string,",
				"          {Commission Unearned 2} as string,",
				"          {NET Contract Amount 2} as string,",
				"          {NET Earned Current 2} as string,",
				"          {NET Earned Cumulative 2} as string,",
				"          {NET Unearned 2} as string,",
				"          {NET RetailAmount 2} as string,",
				"          {Retail Earned Current 2} as string,",
				"          {Retail Earned Cumulative 2} as string,",
				"          {Retail Unearned 2} as string,",
				"          {Earning Curve 3 Id} as string,",
				"          {Earning Curve Name 3} as string,",
				"          {Earning Factor Current 3} as string,",
				"          {Earning Factor Cumulative 3} as string,",
				"          {Admin Amount 3} as string,",
				"          {Cancel Admin Amount 3} as string,",
				"          {NET Admin Amount 3} as string,",
				"          {Admin Earned Current 3} as string,",
				"          {Admin Earned Cumulative 3} as string,",
				"          {Admin Unearned 3} as string,",
				"          {Reserve Amount 3} as string,",
				"          {Cancel Reserve Amount 3} as string,",
				"          {NET Reserve Amount 3} as string,",
				"          {Reserve Earned Current 3} as string,",
				"          {Reserve Earned Cumulative 3} as string,",
				"          {Reserve Unearned 3} as string,",
				"          {Commission Amount 3} as string,",
				"          {Cancel Commission Amount 3} as string,",
				"          {NET Commission Amount 3} as string,",
				"          {Commission Earned Current 3} as string,",
				"          {Commission Earned Cumulative 3} as string,",
				"          {Commission Unearned 3} as string,",
				"          {NET Contract Amount 3} as string,",
				"          {NET Earned Current 3} as string,",
				"          {NET Earned Cumulative 3} as string,",
				"          {NET Unearned 3} as string,",
				"          {NET RetailAmount 3} as string,",
				"          {Retail Earned Current 3} as string,",
				"          {Retail Earned Cumulative 3} as string,",
				"          {Retail Unearned 3} as string,",
				"          {Data Source} as string,",
				"          {Extract Data/Time} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 derive(each(match(instr(lower(name),'date')>0), $$ = toDate($$, 'MM/dd/YYY')),",
				"          {Activated Year-Month} = substring({Activated Year-Month},0,7)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     input(",
				"          {TPA Code} as string,",
				"          {Contract Id} as string,",
				"          {Accounting Month} as date,",
				"          {Insurer Code} as string,",
				"          {Product Type Code} as string,",
				"          {Agent Number} as string,",
				"          {Agent Name} as string,",
				"          {Seller Type} as string,",
				"          {Dealer Number} as string,",
				"          {Dealer Name} as string,",
				"          {Stock Number} as string,",
				"          {Contract Number} as string,",
				"          {Contract Status} as string,",
				"          {Term Months} as decimal(18,2),",
				"          {Term Miles} as decimal(18,2),",
				"          {Sale Odometer} as decimal(18,2),",
				"          {Sale Date} as date,",
				"          {Effective Date} as date,",
				"          {Expiration Date} as date,",
				"          {Activation Date} as date,",
				"          {Activated Year-Month} as string,",
				"          {Billed Date} as date,",
				"          {Cancellation Date} as date,",
				"          {Coverage Code} as string,",
				"          {Coverage Description} as string,",
				"          {Coverage Group Code} as string,",
				"          {Report Group Code} as string,",
				"          {Written NET Amount} as decimal(18,2),",
				"          {Cancel NET Amount} as decimal(18,2),",
				"          {NET Contract Amount} as decimal(18,2),",
				"          {Cancel Fee Amount} as decimal(18,2),",
				"          {Paid Claim Deduction} as decimal(18,2),",
				"          {Retail Amount} as decimal(18,2),",
				"          {Cancel Retail Amount} as decimal(18,2),",
				"          {NET Retail Amount} as decimal(18,2),",
				"          {Retail Refund Amount} as decimal(18,2),",
				"          {Earning Date} as date,",
				"          {Earning Curve 1 Id} as string,",
				"          {Earning Curve Name 1} as string,",
				"          {Earning Factor Current 1} as decimal(18,2),",
				"          {Earning Factor Cumulative 1} as decimal(18,2),",
				"          {Admin Amount 1} as decimal(18,2),",
				"          {Cancel Admin Amount 1} as decimal(18,2),",
				"          {NET Admin Amount 1} as decimal(18,2),",
				"          {Admin Earned Current 1} as decimal(18,2),",
				"          {Admin Earned Cumulative 1} as decimal(18,2),",
				"          {Admin Unearned 1} as decimal(18,2),",
				"          {Reserve Amount 1} as decimal(18,2),",
				"          {Cancel Reserve Amount 1} as decimal(18,2),",
				"          {NET Reserve Amount 1} as decimal(18,2),",
				"          {Reserve Earned Current 1} as decimal(18,2),",
				"          {Reserve Earned Cumulative 1} as decimal(18,2),",
				"          {Reserve Unearned 1} as decimal(18,2),",
				"          {Commission Amount 1} as decimal(18,2),",
				"          {Cancel Commission Amount 1} as decimal(18,2),",
				"          {NET Commission Amount 1} as decimal(18,2),",
				"          {Commission Earned Current 1} as decimal(18,2),",
				"          {Commission Earned Cumulative 1} as decimal(18,2),",
				"          {Commission Unearned 1} as decimal(18,2),",
				"          {NET Contract Amount 1} as decimal(18,2),",
				"          {NET Earned Current 1} as decimal(18,2),",
				"          {NET Earned Cumulative 1} as decimal(18,2),",
				"          {NET Unearned 1} as decimal(18,2),",
				"          {NET RetailAmount 1} as decimal(18,2),",
				"          {Retail Earned Current 1} as decimal(18,2),",
				"          {Retail Earned Cumulative 1} as decimal(18,2),",
				"          {Retail Unearned 1} as decimal(18,2),",
				"          {Earning Curve 2 Id} as string,",
				"          {Earning Curve Name 2} as string,",
				"          {Earning Factor Current 2} as decimal(18,2),",
				"          {Earning Factor Cumulative 2} as decimal(18,2),",
				"          {Admin Amount 2} as decimal(18,2),",
				"          {Cancel Admin Amount 2} as decimal(18,2),",
				"          {NET Admin Amount 2} as decimal(18,2),",
				"          {Admin Earned Current 2} as decimal(18,2),",
				"          {Admin Earned Cumulative 2} as decimal(18,2),",
				"          {Admin Unearned 2} as decimal(18,2),",
				"          {Reserve Amount 2} as decimal(18,2),",
				"          {Cancel Reserve Amount2} as decimal(18,2),",
				"          {NET Reserve Amount 2} as decimal(18,2),",
				"          {Reserve Earned Current 2} as decimal(18,2),",
				"          {Reserve Earned Cumulative 2} as decimal(18,2),",
				"          {Reserve Unearned 2} as decimal(18,2),",
				"          {Commission Amount2} as decimal(18,2),",
				"          {Cancel Commission Amount 2} as decimal(18,2),",
				"          {NET Commission Amount 2} as decimal(18,2),",
				"          {Commission Earned Current 2} as decimal(18,2),",
				"          {Commission Earned Cumulative 2} as decimal(18,2),",
				"          {Commission Unearned 2} as decimal(18,2),",
				"          {NET Contract Amount 2} as decimal(18,2),",
				"          {NET Earned Current 2} as decimal(18,2),",
				"          {NET Earned Cumulative 2} as decimal(18,2),",
				"          {NET Unearned 2} as decimal(18,2),",
				"          {NET RetailAmount 2} as decimal(18,2),",
				"          {Retail Earned Current 2} as decimal(18,2),",
				"          {Retail Earned Cumulative 2} as decimal(18,2),",
				"          {Retail Unearned 2} as decimal(18,2),",
				"          {Earning Curve 3 Id} as string,",
				"          {Earning Curve Name 3} as string,",
				"          {Earning Factor Current 3} as decimal(18,2),",
				"          {Earning Factor Cumulative 3} as decimal(18,2),",
				"          {Admin Amount 3} as decimal(18,2),",
				"          {Cancel Admin Amount 3} as decimal(18,2),",
				"          {NET Admin Amount 3} as decimal(18,2),",
				"          {Admin Earned Current 3} as decimal(18,2),",
				"          {Admin Earned Cumulative 3} as decimal(18,2),",
				"          {Admin Unearned 3} as decimal(18,2),",
				"          {Reserve Amount 3} as decimal(18,2),",
				"          {Cancel Reserve Amount 3} as decimal(18,2),",
				"          {NET Reserve Amount 3} as decimal(18,2),",
				"          {Reserve Earned Current 3} as decimal(18,2),",
				"          {Reserve Earned Cumulative 3} as decimal(18,2),",
				"          {Reserve Unearned 3} as decimal(18,2),",
				"          {Commission Amount 3} as decimal(18,2),",
				"          {Cancel Commission Amount 3} as decimal(18,2),",
				"          {NET Commission Amount 3} as decimal(18,2),",
				"          {Commission Earned Current 3} as decimal(18,2),",
				"          {Commission Earned Cumulative 3} as decimal(18,2),",
				"          {Commission Unearned 3} as decimal(18,2),",
				"          {NET Contract Amount 3} as decimal(18,2),",
				"          {NET Earned Current 3} as decimal(18,2),",
				"          {NET Earned Cumulative 3} as decimal(18,2),",
				"          {NET Unearned 3} as decimal(18,2),",
				"          {NET RetailAmount 3} as decimal(18,2),",
				"          {Retail Earned Current 3} as decimal(18,2),",
				"          {Retail Earned Cumulative 3} as decimal(18,2),",
				"          {Retail Unearned 3} as decimal(18,2),",
				"          {Data Source} as string,",
				"          {Extract Data/Time} as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     )) ~> sink1"
			]
		}
	}
}