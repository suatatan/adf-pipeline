{
	"name": "ContractExportDataFlow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ContractExport",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ContractExportSQL",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {Accounting Period} as string,",
				"          {Activation Date} as string,",
				"          Agent as string,",
				"          {Alternate Name} as string,",
				"          {Amount Financed} as string,",
				"          APR as string,",
				"          {Balloon Amount} as string,",
				"          {Billing Date} as string,",
				"          {Cancel Amount} as string,",
				"          {Cancel Amount (w/out Tax)} as string,",
				"          {Cancel Bill Date} as string,",
				"          {Cancel Factor %} as string,",
				"          {Cancel Method} as string,",
				"          {Cancel Reason} as string,",
				"          {Cancel Report Date} as string,",
				"          {Cancellation Effective Date} as string,",
				"          {Cancellation Fee} as string,",
				"          {Cancellation Miles} as string,",
				"          {Check Date} as string,",
				"          {Check Number} as string,",
				"          {Co-Buyer Address 1} as string,",
				"          {Co-Buyer Address 2} as string,",
				"          {Co-Buyer City} as string,",
				"          {Co-Buyer Country} as string,",
				"          {Co-Buyer Email} as string,",
				"          {Co-Buyer First Name} as string,",
				"          {Co-Buyer Last Name} as string,",
				"          {Co-Buyer Phone Number} as string,",
				"          {Co-Buyer Secondary Phone Number} as string,",
				"          {Co-Buyer State} as string,",
				"          {Co-Buyer Zip Code} as string,",
				"          {Contract #} as string,",
				"          {Contract Payment Batch Number} as string,",
				"          {Contract Status} as string,",
				"          {Coverage Code} as string,",
				"          {Coverage Name} as string,",
				"          {Created By User} as string,",
				"          Culture as string,",
				"          Currency as string,",
				"          {Customer Address 1} as string,",
				"          {Customer Address 2} as string,",
				"          {Customer City} as string,",
				"          {Customer Country} as string,",
				"          {Customer Email} as string,",
				"          {Customer First Name} as string,",
				"          {Customer Last Name} as string,",
				"          {Customer Phone Number} as string,",
				"          {Customer Secondary Phone} as string,",
				"          {Customer State} as string,",
				"          {Customer Write Off Amount} as string,",
				"          {Customer Zip Code} as string,",
				"          {Deal Number} as string,",
				"          {Dealer Address 1} as string,",
				"          {Dealer Address 2} as string,",
				"          {Dealer City} as string,",
				"          {Dealer Country} as string,",
				"          {Dealer Name} as string,",
				"          {Dealer Number} as string,",
				"          {Dealer Remit tax 1} as string,",
				"          {Dealer Remit tax 2} as string,",
				"          {Dealer State/Province} as string,",
				"          {Dealer Zip Code} as string,",
				"          {Deductible Amount} as string,",
				"          {Effective Date} as string,",
				"          {Effective Odometer} as string,",
				"          {Entry Date} as string,",
				"          {Expiration Date} as string,",
				"          {Expiration Odometer} as string,",
				"          {F&I Manager EID} as string,",
				"          {F&I Manager Licence #} as string,",
				"          {F&I Manager Name} as string,",
				"          {F&I Markup} as string,",
				"          {Finance Type} as string,",
				"          {Finance/Lease Term} as string,",
				"          {First Payment Date} as string,",
				"          {In-Service Date} as string,",
				"          {Insurance Company} as string,",
				"          {Insurance Company Code} as string,",
				"          Invoice as string,",
				"          Lender as string,",
				"          {Monthly Payment} as string,",
				"          {MSRP/NADA} as string,",
				"          {Net Cost} as string,",
				"          {Paid Claim Deduction} as string,",
				"          {Pay Method} as string,",
				"          {Payee Type} as string,",
				"          {Payment Frequency} as string,",
				"          {Product Type} as string,",
				"          Reason as string,",
				"          {Ref. Number} as string,",
				"          {Refund From Dealer} as string,",
				"          {Refund From TPA} as string,",
				"          {Register Ref #} as string,",
				"          {Remittance Number} as string,",
				"          {Report Group} as string,",
				"          {Retail Cost} as string,",
				"          {Retail Refund Base} as string,",
				"          {Retail Tax 1} as string,",
				"          {Retail Tax 2} as string,",
				"          {Sale Date} as string,",
				"          {Sale Odometer} as string,",
				"          Source as string,",
				"          {Status (New Business, Cancellation, Upgrade, Adjustment)} as string,",
				"          {Stock Number} as string,",
				"          {Submitted Amount} as string,",
				"          {Term Mileage} as string,",
				"          {Term Month} as string,",
				"          {Term Months/Term Distance} as string,",
				"          Tier as string,",
				"          {Total Admin} as string,",
				"          {Total Commission} as string,",
				"          {Total Dealer Remit Taxes} as string,",
				"          {Total Options/Surcharges} as string,",
				"          {Total Payments} as string,",
				"          {Total Reserves} as string,",
				"          {Total Retail Taxes} as string,",
				"          {Vehicle Age Type} as string,",
				"          {Vehicle Class} as string,",
				"          {Vehicle Color} as string,",
				"          {Vehicle Make} as string,",
				"          {Vehicle Model} as string,",
				"          {Vehicle Nitrogen Installed} as string,",
				"          {Vehicle Purchase Price} as string,",
				"          {Vehicle Year} as string,",
				"          VIN as string,",
				"          {WrittenAmount.ADMIN.CHEMICAL} as string,",
				"          {WrittenAmount.ADMIN.AGENTNCB} as string,",
				"          {WrittenAmount.ADMIN.ROADSIDE} as string,",
				"          {WrittenAmount.ADMIN.BASEADMIN} as string,",
				"          {WrittenAmount.ADMIN.NCBFEE} as string,",
				"          {WrittenAmount.ADMIN.MARKETINGFEE} as string,",
				"          {WrittenAmount.ADMIN.EARLY CLAIM} as string,",
				"          {WrittenAmount.COMMISSION.SPIFF} as string,",
				"          {WrittenAmount.COMMISSION.DLROVERREMIT} as string,",
				"          {WrittenAmount.COMMISSION.DEALERCOMM} as string,",
				"          {WrittenAmount.COMMISSION.CGRJVCO} as string,",
				"          {WrittenAmount.COMMISSION.MGMT FEE} as string,",
				"          {WrittenAmount.COMMISSION.AGENTCOMM2} as string,",
				"          {WrittenAmount.COMMISSION.INCENTIVE} as string,",
				"          {WrittenAmount.COMMISSION.MGMTFEE} as string,",
				"          {WrittenAmount.COMMISSION.AGENTCOMM} as string,",
				"          {WrittenAmount.COMMISSION.DLRHOLDCO} as string,",
				"          {WrittenAmount.COMMISSION.AGENTCOMM3} as string,",
				"          {WrittenAmount.COMMISSION.OWNERSCOMM} as string,",
				"          {WrittenAmount.RESERVE.CLIP} as string,",
				"          {WrittenAmount.RESERVE.SURCHARGERESERVE} as string,",
				"          {WrittenAmount.RESERVE.BASERESERVE} as string,",
				"          {WrittenAmount.RESERVE.WINDSHIELD RESERVE} as string,",
				"          {CancelledAmount.ADMIN.CHEMICAL} as string,",
				"          {CancelledAmount.ADMIN.NCBFEE} as string,",
				"          {CancelledAmount.ADMIN.AGENTNCB} as string,",
				"          {CancelledAmount.ADMIN.ROADSIDE} as string,",
				"          {CancelledAmount.ADMIN.EARLY CLAIM} as string,",
				"          {CancelledAmount.ADMIN.BASEADMIN} as string,",
				"          {CancelledAmount.ADMIN.MARKETINGFEE} as string,",
				"          {CancelledAmount.COMMISSION.DLROVERREMIT} as string,",
				"          {CancelledAmount.COMMISSION.MGMTFEE} as string,",
				"          {CancelledAmount.COMMISSION.INCENTIVE} as string,",
				"          {CancelledAmount.COMMISSION.OWNERSCOMM} as string,",
				"          {CancelledAmount.COMMISSION.AGENTCOMM3} as string,",
				"          {CancelledAmount.COMMISSION.MGMT FEE} as string,",
				"          {CancelledAmount.COMMISSION.AGENTCOMM2} as string,",
				"          {CancelledAmount.COMMISSION.SPIFF} as string,",
				"          {CancelledAmount.COMMISSION.DEALERCOMM} as string,",
				"          {CancelledAmount.COMMISSION.CGRJVCO} as string,",
				"          {CancelledAmount.COMMISSION.AGENTCOMM} as string,",
				"          {CancelledAmount.COMMISSION.DLRHOLDCO} as string,",
				"          {CancelledAmount.RESERVE.CLIP} as string,",
				"          {CancelledAmount.RESERVE.BASERESERVE} as string,",
				"          {CancelledAmount.RESERVE.SURCHARGERESERVE} as string,",
				"          {CancelledAmount.RESERVE.WINDSHIELD RESERVE} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 derive(each(match(instr(lower(name),'date')>0), $$ = toDate($$, 'MM/dd/YYY'))) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          {Accounting Period} as string,",
				"          {Billing Date} as string,",
				"          {Cancel Amount} as decimal(18,2),",
				"          {Cancel Bill Date} as date,",
				"          {Cancel Factor %} as decimal(18,2),",
				"          {Cancel Reason} as string,",
				"          {Cancellation Fee} as decimal(18,2),",
				"          {Cancellation Miles} as decimal(18,2),",
				"          {Contract #} as string,",
				"          {Contract Status} as string,",
				"          {Coverage Code} as string,",
				"          {Coverage Name} as string,",
				"          {Created By User} as string,",
				"          {Deal Number} as decimal(18,2),",
				"          {Dealer Name} as string,",
				"          {Dealer State/Province} as string,",
				"          {Deductible Amount} as decimal(18,2),",
				"          {Entry Date} as date,",
				"          {Expiration Date} as date,",
				"          {Expiration Odometer} as decimal(18,2),",
				"          {F&I Markup} as decimal(18,2),",
				"          {Insurance Company} as string,",
				"          Lender as string,",
				"          {Net Cost} as decimal(18,2),",
				"          {Paid Claim Deduction} as decimal(18,2),",
				"          {Product Type} as string,",
				"          {Refund From TPA} as decimal(18,2),",
				"          {Retail Cost} as decimal(18,2),",
				"          {Retail Refund Base} as decimal(18,2),",
				"          {Sale Date} as date,",
				"          {Sale Odometer} as decimal(18,2),",
				"          {Term Mileage} as decimal(18,2),",
				"          {Term Month} as integer,",
				"          {Vehicle Age Type} as string,",
				"          {Vehicle Class} as string,",
				"          {Vehicle Make} as string,",
				"          {Vehicle Model} as string,",
				"          {Vehicle Purchase Price} as decimal(18,2),",
				"          {Vehicle Year} as integer,",
				"          VIN as string,",
				"          {WrittenAmount.ADMIN.CHEMICAL} as decimal(18,2),",
				"          {WrittenAmount.ADMIN.ROADSIDE} as decimal(18,2),",
				"          {WrittenAmount.ADMIN.BASEADMIN} as decimal(18,2),",
				"          {WrittenAmount.ADMIN.EARLY CLAIM} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.SPIFF} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.DEALERCOMM} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.CGRJVCO} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.MGMT FEE} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.AGENTCOMM2} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.INCENTIVE} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.MGMTFEE} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.AGENTCOMM} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.DLRHOLDCO} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.AGENTCOMM3} as decimal(18,2),",
				"          {WrittenAmount.COMMISSION.OWNERSCOMM} as decimal(18,2),",
				"          {WrittenAmount.RESERVE.SURCHARGERESERVE} as decimal(18,2),",
				"          {WrittenAmount.RESERVE.BASERESERVE} as decimal(18,2),",
				"          {CancelledAmount.ADMIN.CHEMICAL} as decimal(18,2),",
				"          {CancelledAmount.ADMIN.ROADSIDE} as decimal(18,2),",
				"          {CancelledAmount.ADMIN.EARLY CLAIM} as decimal(18,2),",
				"          {CancelledAmount.ADMIN.BASEADMIN} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.MGMTFEE} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.INCENTIVE} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.OWNERSCOMM} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.AGENTCOMM3} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.MGMT FEE} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.AGENTCOMM2} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.SPIFF} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.DEALERCOMM} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.CGRJVCO} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.AGENTCOMM} as decimal(18,2),",
				"          {CancelledAmount.COMMISSION.DLRHOLDCO} as decimal(18,2),",
				"          {CancelledAmount.RESERVE.SURCHARGERESERVE} as decimal(18,2),",
				"          {CancelledAmount.RESERVE.BASERESERVE} as decimal(18,2),",
				"          {Activation Date} as string,",
				"          Agent as string,",
				"          {Cancel Amount (w/out Tax)} as string,",
				"          {Cancel Method} as string,",
				"          {Cancel Report Date} as string,",
				"          {Cancellation Effective Date} as string,",
				"          {Dealer Address 1} as string,",
				"          {Dealer Address 2} as string,",
				"          {Dealer City} as string,",
				"          {Dealer Country} as string,",
				"          {Dealer Number} as string,",
				"          {Dealer Remit tax 1} as string,",
				"          {Dealer Remit tax 2} as string,",
				"          {Dealer Zip Code} as string,",
				"          {Effective Date} as string,",
				"          {Effective Odometer} as string,",
				"          {Insurance Company Code} as string,",
				"          {MSRP/NADA} as string,",
				"          {Refund From Dealer} as string,",
				"          {Register Ref #} as string,",
				"          {Remittance Number} as string,",
				"          {Retail Tax 1} as string,",
				"          {Retail Tax 2} as string,",
				"          {Status (New Business, Cancellation, Upgrade, Adjustment)} as string,",
				"          {Stock Number} as string,",
				"          {Submitted Amount} as string,",
				"          {Term Months/Term Distance} as string,",
				"          Tier as string,",
				"          {Total Admin} as string,",
				"          {Total Commission} as string,",
				"          {Total Dealer Remit Taxes} as string,",
				"          {Total Options/Surcharges} as string,",
				"          {Total Reserves} as string,",
				"          {Total Retail Taxes} as string,",
				"          {Vehicle Color} as string,",
				"          {WrittenAmount.ADMIN.AGENTNCB} as string,",
				"          {WrittenAmount.ADMIN.NCBFEE} as string,",
				"          {WrittenAmount.ADMIN.MARKETINGFEE} as string,",
				"          {WrittenAmount.COMMISSION.DLROVERREMIT} as string,",
				"          {WrittenAmount.RESERVE.CLIP} as string,",
				"          {WrittenAmount.RESERVE.WINDSHIELD RESERVE} as string,",
				"          {CancelledAmount.ADMIN.NCBFEE} as string,",
				"          {CancelledAmount.ADMIN.AGENTNCB} as string,",
				"          {CancelledAmount.ADMIN.MARKETINGFEE} as string,",
				"          {CancelledAmount.COMMISSION.DLROVERREMIT} as string,",
				"          {CancelledAmount.RESERVE.CLIP} as string,",
				"          {CancelledAmount.RESERVE.WINDSHIELD RESERVE} as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}